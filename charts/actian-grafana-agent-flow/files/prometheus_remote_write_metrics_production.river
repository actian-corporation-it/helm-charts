// Prometheus Remote Write URL
argument "url" {
	optional = false
}

// Prometheus User
argument "username" {
	optional = false
}

// Prometheus Password
argument "password" {
	optional = false
}

// Grafana Stack name (for Mimir Tenant Id)
argument "grafana_stack" {
	optional = false
}

// External labels to add to metrics
argument "external_labels" {
	optional = false
}

export "receiver" {
	value = prometheus.remote_write.metrics.receiver
}

prometheus.remote_write "metrics" {
	external_labels = json_decode(argument.external_labels.value)

	endpoint {
		url = argument.url.value

		basic_auth {
			username = argument.username.value
			password = argument.password.value
		}
	}
}
