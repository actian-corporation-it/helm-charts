// Loki Write URL
argument "url" {
	optional = false
}

// Loki User
argument "username" {
	optional = false
}

// Loki Password
argument "password" {
	optional = false
}

// Grafana Stack name (for Mimir Tenant Id)
argument "grafana_stack" {
	optional = false
}

// External labels to add to log records
argument "external_labels" {
	optional = false
}

export "receiver" {
	value = loki.write.logs.receiver
}

loki.write "logs" {
	external_labels = json_decode(argument.external_labels.value)

	endpoint {
		url = argument.url.value

		basic_auth {
			username = argument.username.value
			password = argument.password.value
		}
	}
}
