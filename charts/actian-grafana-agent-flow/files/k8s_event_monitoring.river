// Arguments

// forward_logs_to must be a list(LogsReceiver) where log entries
// should be forwarded.
argument "forward_logs_to" {
	optional = false
}

// scrape_interval is a duration which specifies how frequently to collect
// metrics.
argument "scrape_interval" {
	optional = true
	default  = "30s"
}

// scrape_timeout is a duration which specifies how long to wait for a single
// metrics collection to complete.
argument "scrape_timeout" {
	optional = true
	default  = "10s"
}

// Processing

loki.source.kubernetes_events "eventhandler" {
	job_name = "integrations/kubernetes/eventhandler"

	forward_to = [loki.relabel.eventhandler.receiver]
}

loki.relabel "eventhandler" {
	forward_to = argument.forward_logs_to.value

	rule {
		source_labels = ["instance"]
		regex         = "loki\\.source\\.kubernetes_events\\.(.+)"
		target_label  = "instance"
	}
}
